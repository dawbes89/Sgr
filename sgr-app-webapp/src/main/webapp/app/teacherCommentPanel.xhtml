<!DOCTYPE composition>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" template="template.xhtml">

	<ui:define name="content">
		<!-- 	MAIN TABLE -->
		<h:form id="root">
			<p:remoteCommand name="onload" action="#{teacherCommentPanel.onLoad}"
				autoRun="true" update=":root:table" />

			<p:outputPanel id="panel" style="text-align:center;" layout="block">

				<p:dataTable id="table" var="student"
					value="#{teacherCommentPanel.entities}" editable="true">
					<p:column headerText="#{sgr_translation.form_person_firstName}"
						filterBy="#{student.person.firstName}" filterMatchMode="contains">
						<p:outputLabel value="#{student.person.firstName}" />
					</p:column>
					<p:column headerText="#{sgr_translation.form_person_lastName}"
						filterBy="#{student.person.lastName}" filterMatchMode="contains">
						<p:outputLabel value="#{student.person.lastName}" />
					</p:column>
					<p:column headerText="#{sgr_translation.form_class}">
						<p:outputLabel value="#{student.classGroup.className}" />
					</p:column>
					<p:column width="40">
						<!-- REVIEW tutaj pasowało by inne tłumaczenie, coś w stylu "uwagi" lub "edytuj uwagi" -->
						<p:commandButton title="#{sgr_translation.button_update}"
							action="#{teacherCommentPanel.findComments}" update=":add:panel"
							oncomplete="PF('addDialog').show()" icon="ui-icon-pencil">
							<f:setPropertyActionListener value="#{student}"
								target="#{teacherCommentPanel.entity}" />
						</p:commandButton>
					</p:column>
				</p:dataTable>
			</p:outputPanel>
		</h:form>

		<!-- ADD FORM -->
		<p:dialog widgetVar="addDialog"
			header="#{sgr_translation.form_window_caption_add}" resizable="false"
			showEffect="fold" hideEffect="fold" width="650px" height="500px"
			closable="false" draggable="false" modal="true" appendTo="@(body)"
			focus=":add:content">
			<h:form id="add">
				<p:panelGrid id="panel" columns="1" columnClasses="grid">
					<p:messages id="msgs" />

					<!-- REVIEW te pola z dodawaniem uwag zamknij w p:panel jak masz niżej pozostałe uwagi -->
					<!-- i jeszcze w gridzie z dwoma kolumnami, czyli to co jest do separatora, jak to zrobisz -->
					<!-- dopasuj szerokość pola z trescią uwagi do całego okna -->
					<p:outputLabel for="type" value="#{sgr_translation.form_type}" />
					<p:selectOneMenu id="type"
						value="#{teacherCommentPanel.comment.commentType}" var="status"
						required="true">
						<f:selectItem itemValue="POSITIVE"
							itemLabel="#{sgr_translation.comment_type_positive}" />
						<f:selectItem itemValue="NEGATIVE"
							itemLabel="#{sgr_translation.comment_type_negative}" />
						<f:selectItem itemValue="REPREHENSIBLE"
							itemLabel="#{sgr_translation.comment_type_reprehensible}" />
					</p:selectOneMenu>

					<p:outputLabel for="content"
						value="#{sgr_translation.form_content}:" />
					<p:inputTextarea id="content" rows="6" cols="50"
						label="#{sgr_translation.form_content}"
						value="#{teacherCommentPanel.comment.content}" required="true" />

					<!-- REVIEW separator niepotrzebny -->
					<p:separator />

					<!-- REVIEW dodaj na tym panelu, że można go zamykać i żeby był domyślnie zamknięty -->
					<p:panel id="otherCommentsPanel"
						header="#{sgr_translation.form_other_student_comments}">
						<p:panelGrid columns="2" columnClasses="label, value">
							<p:dataTable id="commentTable" var="comment"
								value="#{teacherCommentPanel.comments}" editable="true">
								<p:column headerText="#{sgr_translation.form_date_of_issue}">
									<p:outputLabel value="#{comment.date}"
										converter="yearConverter" />
								</p:column>
								<p:column headerText="#{sgr_translation.form_content}">
									<p:outputLabel value="#{comment.content}" />
								</p:column>
								<p:column headerText="#{sgr_translation.form_type}">
									<p:outputLabel value="#{comment.commentType}"
										converter="enumTranslationConverter" />
								</p:column>
								<p:column headerText="#{sgr_translation.form_issuer_name}">
									<p:outputLabel value="#{comment.issuerName}" />
								</p:column>
							</p:dataTable>
						</p:panelGrid>
					</p:panel>

					<!-- REVIEW te przyciski przenies wyzej ponad tabele z pozostalymi uwagami -->
					<p:panelGrid columns="3">
						<p:commandButton value="#{sgr_translation.form_button_save}"
							action="#{teacherCommentPanel.create}"
							update=":add:panel :root:panel" icon="ui-icon-disk"
							oncomplete="if (args &amp;&amp; !args.validationFailed) PF('addDialog').hide()">
						</p:commandButton>
						<p:commandButton value="#{sgr_translation.form_button_clear}"
							update=":add:panel" process="@this" icon="ui-icon-close">
							<p:resetInput target=":add:panel" />
						</p:commandButton>
						<p:commandButton value="#{sgr_translation.form_button_cancel}"
							update=":add:panel" process="@this" icon="ui-icon-cancel"
							oncomplete="PF('addDialog').hide()">
							<p:resetInput target=":add:panel" />
						</p:commandButton>
					</p:panelGrid>
				</p:panelGrid>
			</h:form>
		</p:dialog>

	</ui:define>

</ui:composition>